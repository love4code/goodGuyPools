<%- include('partials/header', { title: 'Home', siteSettings }) %>

<% if (siteSettings && siteSettings.hero && siteSettings.hero.enabled && siteSettings.hero.image) { %>
  <!-- Hero Section with Image -->
  <section class="mb-5 position-relative" style="min-height: 500px; overflow: hidden;">
    <div class="position-absolute top-0 start-0 w-100 h-100" style="background-image: url('<%= siteSettings.hero.image %>'); background-size: cover; background-position: center; z-index: 0;"></div>
    <div class="position-absolute top-0 start-0 w-100 h-100" style="background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.6)); z-index: 1;"></div>
    <div class="position-relative" style="z-index: 2; min-height: 500px; display: flex; align-items: center;">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 mx-auto text-center text-white" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.7);">
            <% if (siteSettings.hero.title) { %>
              <h1 class="display-4 fw-bold mb-4"><%= siteSettings.hero.title %></h1>
            <% } %>
            <% if (siteSettings.hero.subtitle) { %>
              <p class="lead mb-4 fs-4"><%= siteSettings.hero.subtitle %></p>
            <% } %>
            <% if (siteSettings.hero.buttonText && siteSettings.hero.buttonLink) { %>
              <a class="btn btn-primary btn-lg shadow" href="<%= siteSettings.hero.buttonLink %>"><%= siteSettings.hero.buttonText %></a>
            <% } %>
          </div>
        </div>
      </div>
    </div>
  </section>
<% } else { %>
  <!-- Default Home Page Section (when hero is disabled) -->
  <section class="mb-5">
    <div class="p-5 bg-light rounded-3 text-center">
      <h1 class="display-5 fw-bold text-primary">Good Guy Pools</h1>
      <p class="lead mb-4">Custom Swimming Pools & Outdoor Living</p>
      <a class="btn btn-primary btn-lg" href="/contact">Request a Free Quote</a>
    </div>
  </section>
<% } %>

<section class="mb-5">
  <h2 class="h3 mb-4">Our Services</h2>
  <div class="row g-4">
    <% if (services && services.length) { %> <% services.forEach(s => { %>
    <div class="col-md-3">
      <div class="card h-100 text-center">
        <div class="card-body d-flex flex-column">
          <% if (s.icon) { %>
            <div class="mb-3">
              <i class="bi <%= s.icon %>" style="font-size: 3rem; color: #0d6efd;"></i>
            </div>
          <% } %>
          <h3 class="h5 mb-3"><%= s.title %></h3>
          <p class="card-text flex-grow-1"><%= s.description %></p>
        </div>
      </div>
    </div>
    <% }) %> <% } else { %>
    <div class="col-12">
      <div class="alert alert-secondary">
        No services yet. Add some in Admin → Services.
      </div>
    </div>
    <% } %>
  </div>
</section>

<section class="mb-5">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="h3 mb-0">Recent Projects</h2>
    <a href="/portfolio" class="btn btn-outline-primary btn-sm">View All</a>
  </div>
  <div class="row g-4">
    <% if (projects && projects.length) { %> 
      <% projects.forEach(p => { %>
        <div class="col-lg-3 col-md-6">
          <div class="card h-100">
            <% if (p.featuredImage) { %>
              <img
                src="<%= p.featuredImage %>"
                class="card-img-top"
                alt="<%= p.title %>"
                style="height: 200px; object-fit: cover;"
              />
            <% } %>
            <div class="card-body d-flex flex-column">
              <h3 class="h5"><%= p.title %></h3>
              <div class="text-muted small mb-2">
                <%= p.location || '' %> · <%= p.projectType %>
              </div>
              <% if (p.shortDescription) { %>
                <p class="card-text flex-grow-1"><%= p.shortDescription %></p>
              <% } %>
              <a href="/portfolio/<%= p.slug %>" class="btn btn-sm btn-primary mt-auto">View Project</a>
            </div>
          </div>
        </div>
      <% }) %> 
    <% } else { %>
      <div class="col-12">
        <div class="alert alert-secondary">No featured projects yet.</div>
      </div>
    <% } %>
  </div>
</section>

<section class="mb-5">
  <div class="row text-center g-4">
    <div class="col-md-3">
      <div class="p-3 bg-light rounded">Licensed & Insured</div>
    </div>
    <div class="col-md-3">
      <div class="p-3 bg-light rounded">Free Estimates</div>
    </div>
    <div class="col-md-3">
      <div class="p-3 bg-light rounded">
        Serving <%= (siteSettings && siteSettings.serviceArea) || 'Your Area' %>
      </div>
    </div>
    <div class="col-md-3">
      <div class="p-3 bg-light rounded">Quality Craftsmanship</div>
    </div>
  </div>
</section>

<section>
  <div class="row">
    <div class="col-lg-8 mx-auto">
      <div class="card">
        <div class="card-body">
          <h2 class="h4 mb-3">Get In Touch</h2>
          <% if (success) { %>
          <div class="alert alert-success">
            Thanks! Your inquiry has been received.
          </div>
          <% } %> <% if (errors && errors.length) { %>
          <div class="alert alert-danger"><%= errors.join(', ') %></div>
          <% } %>
          <form action="/contact" method="POST" class="row g-3">
            <div class="col-md-6">
              <label class="form-label">Name *</label>
              <input type="text" name="name" class="form-control" required />
            </div>
            <div class="col-md-6">
              <label class="form-label">Town *</label>
              <input type="text" name="town" class="form-control" required />
            </div>
            <div class="col-md-6">
              <label class="form-label">Phone Number *</label>
              <input
                type="tel"
                name="phoneNumber"
                class="form-control"
                required
              />
            </div>
            <div class="col-md-6">
              <label class="form-label">Email *</label>
              <input type="email" name="email" class="form-control" required />
            </div>
            <div class="col-md-6">
              <label class="form-label">Project Type *</label>
              <select name="projectType" class="form-select" required>
                <option value="">Select...</option>
                <option>New pool construction</option>
                <option>Renovation</option>
                <option>Maintenance/Service</option>
              </select>
            </div>
            <div class="col-12">
              <label class="form-label">Message</label>
              <textarea name="message" rows="4" class="form-control"></textarea>
            </div>
            <input type="text" name="honey" style="display: none" />
            <div class="col-12">
              <button class="btn btn-primary">Send Message</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>

<%- include('partials/footer', { siteSettings }) %>
